- name: Launch Cloudformation Stack
  cloudformation:
    stack_name: "{{ cfn_stackname }}"
    state: "present"
    region: "us-west-2"
    disable_rollback: true
    template_url: "https://s3-us-west-2.amazonaws.com/adamlashhaws-cloudformation-templates/{{ cfn_branch }}/ec2/ec2-standalone.yaml"
    template_parameters:
      ParventVPCStack: "{{ cfn_parentvpc }}"
      InstanceType: "{{ cfn_instancetype }}"
      AMIID: "{{ cfn_ami }}"
      Name: "{{ cfn_instancename }}"
      SubnetName: "{{ cfn_subnet }}"
      KeyName: "{{ cfn_keyname | default([]) }}"
      SSHAccessGroup: "{{ cfn_sshaccessgroup | default([]) }}"
      SSHAccessCIDR: "{{ cfn_sshaccesscidr | default([]) }}"
      DataDisk: "{{ cfn_datadisk | default([]) }}"
      ParentAWXStack: "{{ cfn_awxstack }}"
      AWXorSSM: "{{ cfn_ssmorawxmanage }}"
    tags:
      CreatedBy: "AWX Template - Standalone EC2 Instance Creation"
      Role: "{{ cfn_roletag }}"
